---
title: "GO-Analysis-with-HypeR"
output: html_document
---
## Geneontology analysis

HypeR strores te information of diverent data bases for several organisms:
```{r hypeR_datasets, include=T, eval = F}
library(hypeR)
# hypeR strores te information of diverent data bases for several organisms
msigdb_info()
```

From this we can load for example the REACTOME pathway information:

```{r load_REACTOME_geneset, include=T, eval = F}
# get pathway info from reactome
reactome_geneset <- msigdb_gsets("Homo sapiens", "C2", "CP:REACTOME")
```

Now we want to know how many of the genes we found to be bound, belong to which of the reactome pathways. For this, we make a list of the names of all bound genes. We also need a background against which we test, wheter a certain term is enriched. The background should contain all genes, that could have been detected as a hit. This usually means all genes, that where expressed in you experimental system. For example if you look at differental expression with DEseq, you could choose all genes with a baseMean > 0 oder > 1 as expressed genes. Then hypR test for the overlap of the genes belonging to each pathway or GO term considering only genes that were present in the background:

```{r reactome_overlap, include=T, eval = F}
# get names of bound genes
bound_gene_names <- hit_genes$gene_name
background <- expressed_genes$gene_name
# test enrichment of genes in reactome pathways
reactome_hyp <- hypeR(bound_gene_names, reactome_geneset, test="hypergeometric", fdr=0.05, background=background)
reactome_hyp
# Plot dots plot
reactome_dot <- hyp_dots(reactome_hyp, top = 20)+ # with top you can set the number of top terms to show
  ggtitle("bla")
reactome_dot
```

You can also get a data.frame of the hypR results and then make your own plots in ggplot, extract terms of interest or choose differnet p-value cutoffs.

```{r reactome_overlap, include=T, eval = F}

reactome_hyp$data

```

**Exercise: GO termes**
Another often used data base is Geneontology. Geneontology stores three types of information: Cellular Components, Molecular Functions and biological progesses. All three are also availabe as genesets from hypeR (See msigdb_info()). Make the corrisponding dotplots for these genesets.
